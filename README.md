# üîÆ DeepCode Charm Framework

> **Framework modular e intuitivo para bots Discord - A alternativa moderna ao aoi.js**

[![Bun](https://img.shields.io/badge/Bun-1.0+-000000?style=flat&logo=bun)](https://bun.sh)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.0+-3178C6?style=flat&logo=typescript)](https://www.typescriptlang.org/)
[![Discord.js](https://img.shields.io/badge/Discord.js-14.0+-5865F2?style=flat&logo=discord)](https://discord.js.org)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

## ‚ú® Por que DeepCode Charm?

### üéØ **Familiar e F√°cil**
Se voc√™ j√° usou **aoi.js**, vai se sentir em casa! Mesma sintaxe simples:
```javascript
// Funciona exatamente como aoi.js
$say Ol√° mundo!
$ping
$embed T√≠tulo|Descri√ß√£o|cor
```

### üöÄ **Moderno e Perform√°tico**
- ‚ö° **Runtime Bun** - At√© 3x mais r√°pido que Node.js
- üîí **TypeScript nativo** - Type safety completa
- üõ°Ô∏è **Seguran√ßa avan√ßada** - Rate limiting e valida√ß√µes
- üìä **Logs inteligentes** - Auditoria completa

### üß© **Sistema de Charms**
Charms s√£o blocos de constru√ß√£o modulares - como comandos, mas mais poderosos:
```typescript
// Cada charm √© independente e reutiliz√°vel
const meuCharm: CharmFunction = async (context) => {
  await context.message.reply('Meu charm personalizado!');
};
```

## üöÄ In√≠cio R√°pido (5 minutos)

### 1. **Pr√©-requisitos**
```bash
# Instale o Bun (mais r√°pido que npm/yarn)
curl -fsSL https://bun.sh/install | bash

# Ou use npm/yarn se preferir
npm install -g bun
```

### 2. **Instala√ß√£o**
```bash
# Crie seu projeto
mkdir meu-bot-discord
cd meu-bot-discord

# Instale o framework
npm install deepcode-charm
# ou
bun add deepcode-charm
```

### 3. **Configura√ß√£o B√°sica**
Crie `index.js`:
```javascript
import { CharmClient, GatewayIntentBits } from 'deepcode-charm';
import { config } from 'dotenv';

config();

// Crie o cliente do bot
const client = new CharmClient({
  intents: [
    GatewayIntentBits.Guilds,
    GatewayIntentBits.GuildMessages,
    GatewayIntentBits.MessageContent
  ],
  prefix: '$', // Prefixo dos comandos
  status: 'online',
  activity: {
    name: 'com charms m√°gicos ‚ú®',
    type: 'PLAYING'
  }
});

// Os charms b√°sicos j√° v√™m inclusos!
// say, ping, embed, help

// Inicie o bot
client.start(process.env.DISCORD_TOKEN);
```

### 4. **Arquivo .env**
```env
DISCORD_TOKEN=seu_token_aqui
PREFIX=$
BOT_STATUS=online
```

### 5. **Execute!**
```bash
bun run index.js
# ou
node index.js
```

**üéâ Pronto! Seu bot j√° funciona com comandos:**
- `$say Ol√° pessoal!`
- `$ping`
- `$embed Aviso|Manuten√ß√£o hoje|red`
- `$help`

---

## üìö Guia Completo de Uso

### üîÆ **Charms Inclusos**

#### **$say** - Enviar Mensagens
```javascript
// Uso b√°sico
$say Ol√° mundo!
$say Bem-vindos ao servidor! üéâ

// O bot vai:
// 1. Deletar sua mensagem original
// 2. Enviar o texto como se fosse ele
```
- ‚úÖ **Deleta mensagem original** (se tiver permiss√£o)
- ‚úÖ **Valida tamanho** (m√°x 1800 caracteres)
- ‚úÖ **Emojis e men√ß√µes** funcionam normalmente

#### **$ping** - Testar Conectividade
```javascript
$ping

// Resposta:
// üèì Pong!
// üì° Lat√™ncia da API: 45ms
// üí¨ Lat√™ncia da Mensagem: 123ms
```
- ‚úÖ **Lat√™ncia em tempo real**
- ‚úÖ **Informa√ß√µes detalhadas**
- ‚úÖ **Cooldown de 5 segundos**

#### **$embed** - Criar Embeds Lindos
```javascript
// Formato: t√≠tulo|descri√ß√£o|cor
$embed T√≠tulo Incr√≠vel|Esta √© a descri√ß√£o|blue
$embed Aviso Importante|Manuten√ß√£o √†s 22h|red
$embed Tutorial|Como usar este bot|green
$embed Apenas t√≠tulo|Uma descri√ß√£o simples

// Cores dispon√≠veis:
// red, green, blue, yellow, orange, purple, pink
// Ou use c√≥digos hex: #FF5733
```
- ‚úÖ **Cores pr√©-definidas** ou hexadecimal
- ‚úÖ **Valida√ß√£o de tamanho** autom√°tica
- ‚úÖ **Design responsivo**

#### **$help** - Sistema de Ajuda Inteligente
```javascript
$help              // Lista todos os comandos
$help say          // Detalhes do comando espec√≠fico
$help embed        // Informa√ß√µes do comando embed
```
- ‚úÖ **Lista categorizada** de comandos
- ‚úÖ **Ajuda espec√≠fica** por comando
- ‚úÖ **Estat√≠sticas do bot** em tempo real
- ‚úÖ **Comandos admin** aparecem riscados para usu√°rios normais

### ü§ñ **Sistema de Men√ß√µes**

O bot responde automaticamente quando mencionado:
```javascript
// Mencione o bot: @SeuBot
// Ele vai responder com um embed contendo:
// - Informa√ß√µes do bot
// - Prefixo atual
// - Estat√≠sticas em tempo real
// - Sugest√µes de comandos
```

### üîç **Sistema de Sugest√µes Inteligentes**

Errou o nome do comando? Sem problema!
```javascript
// Voc√™ digita:
$sai ol√°

// Bot responde:
// ‚ùå Comando `sai` n√£o encontrado.
// 
// üí° Voc√™ quis dizer:
// ‚Ä¢ `$say`
// ‚Ä¢ `$help`
// 
// üìã Use `$help` para ver todos os comandos.
```

### üõ°Ô∏è **Sistema de Seguran√ßa**

#### **Rate Limiting Autom√°tico**
```javascript
// Configura√ß√£o padr√£o:
// - 10 comandos por minuto por usu√°rio
// - Cooldowns espec√≠ficos por comando
// - Admins t√™m privil√©gios especiais

const client = new CharmClient({
  // ... outras op√ß√µes
  rateLimit: {
    maxCommands: 15,    // M√°x comandos
    timeWindow: 60      // Por minuto
  }
});
```

#### **Sistema de Permiss√µes**
```javascript
const client = new CharmClient({
  // ... outras op√ß√µes
  adminUsers: ['123456789', '987654321'], // IDs de admin
  allowedGuilds: ['guild1', 'guild2']     // Servers permitidos
});
```

#### **Valida√ß√£o de Entrada**
- ‚úÖ **Caracteres perigosos** bloqueados automaticamente
- ‚úÖ **Tamanho de mensagem** limitado
- ‚úÖ **Injection attacks** prevenidos
- ‚úÖ **Logs de seguran√ßa** completos

---

## üîß Criando Seus Pr√≥prios Charms

### **Charm B√°sico**
```javascript
import { CharmFunction, CharmMetadata } from 'deepcode-charm';

// 1. Crie a fun√ß√£o do charm
const meuCharm: CharmFunction = async (context) => {
  const { message, args, user, client } = context;
  
  // Valide argumentos
  if (!args) {
    await message.reply('‚ùå Uso: `$meucharm [argumentos]`');
    return;
  }
  
  // Sua l√≥gica aqui
  await message.channel.send(`${user.username} disse: ${args}`);
};

// 2. Defina os metadados
const meuCharmMetadata: CharmMetadata = {
  name: 'meucharm',
  description: 'Meu primeiro charm personalizado',
  usage: '$meucharm [texto]',
  adminOnly: false,
  cooldown: 3,
  category: 'fun'
};

// 3. Registre no cliente
client.registerCharm(meuCharm, meuCharmMetadata);
```

### **Charm Avan√ßado com Valida√ß√µes**
```javascript
const charmAvancado: CharmFunction = async (context) => {
  const { message, args, user, client } = context;
  
  // Verificar se √© admin
  if (!user.isAdmin) {
    await message.reply('üö´ Comando apenas para administradores');
    return;
  }
  
  // Validar argumentos
  if (!args || args.length < 3) {
    await message.reply('‚ùå M√≠nimo 3 caracteres');
    return;
  }
  
  // Usar recursos do Discord.js
  const embed = new EmbedBuilder()
    .setTitle('Comando Admin Executado')
    .setDescription(`Usu√°rio: ${user.username}\nComando: ${args}`)
    .setColor(0xFF6B35)
    .setTimestamp();
    
  await message.reply({ embeds: [embed] });
  
  // Log personalizado
  client.logger.info(`Admin ${user.username} executou: ${args}`);
};
```

### **Charm com Intera√ß√µes**
```javascript
const charmInterativo: CharmFunction = async (context) => {
  const { message, args } = context;
  
  // Enviar mensagem com bot√µes
  const row = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('confirmar')
        .setLabel('‚úÖ Confirmar')
        .setStyle(ButtonStyle.Success),
      new ButtonBuilder()
        .setCustomId('cancelar')
        .setLabel('‚ùå Cancelar')
        .setStyle(ButtonStyle.Danger)
    );
    
  const response = await message.reply({
    content: 'Escolha uma op√ß√£o:',
    components: [row]
  });
  
  // Aguardar intera√ß√£o
  try {
    const interaction = await response.awaitMessageComponent({
      time: 30000 // 30 segundos
    });
    
    if (interaction.customId === 'confirmar') {
      await interaction.reply('‚úÖ Confirmado!');
    } else {
      await interaction.reply('‚ùå Cancelado!');
    }
  } catch {
    await response.edit({ 
      content: '‚è∞ Tempo esgotado!', 
      components: [] 
    });
  }
};
```

---

## üìä Monitoramento e Logs

### **Sistema de Logs Integrado**
```javascript
// O framework registra automaticamente:
// - Comandos executados
// - Erros e warnings
// - Eventos de seguran√ßa
// - Estat√≠sticas de uso

// Acessar logs programaticamente:
const stats = client.getStats();
console.log(`Comandos executados: ${stats.commandsExecuted}`);
console.log(`Uptime: ${stats.uptime} segundos`);
console.log(`Guilds: ${stats.guildsCount}`);

// Logs customizados:
client.logger.info('Minha mensagem de log');
client.logger.warn('Algo suspeito aconteceu', { userId: '123' });
client.logger.error('Erro cr√≠tico!', error);
```

### **N√≠veis de Log Dispon√≠veis**
```javascript
// DEBUG - Informa√ß√µes detalhadas para desenvolvimento
client.logger.debug('Comando parseado', { comando: 'say', args: 'hello' });

// INFO - Informa√ß√µes gerais do sistema
client.logger.info('Bot conectado com sucesso');

// WARN - Avisos que merecem aten√ß√£o
client.logger.warn('Rate limit atingido', { userId: '123' });

// ERROR - Erros que afetam funcionamento
client.logger.error('Falha ao conectar com Discord API', error);

// FATAL - Erros cr√≠ticos que param o sistema
client.logger.fatal('Conex√£o perdida permanentemente', error);
```

---

## üîß Configura√ß√µes Avan√ßadas

### **Cliente Completo**
```javascript
const client = new CharmClient({
  // Intents necess√°rias
  intents: [
    GatewayIntentBits.Guilds,
    GatewayIntentBits.GuildMessages,
    GatewayIntentBits.MessageContent,
    GatewayIntentBits.GuildMembers, // Para modera√ß√£o
    GatewayIntentBits.GuildVoiceStates // Para m√∫sica
  ],
  
  // Configura√ß√µes b√°sicas
  prefix: '!',
  status: 'dnd', // online, idle, dnd, invisible
  
  // Atividade do bot
  activity: {
    name: 'comandos incr√≠veis',
    type: 'LISTENING' // PLAYING, STREAMING, LISTENING, WATCHING, COMPETING
  },
  
  // Seguran√ßa
  adminUsers: ['sua_id', 'outra_id'],
  allowedGuilds: [], // vazio = todos os servers
  
  // Rate limiting
  rateLimit: {
    maxCommands: 20,  // comandos por per√≠odo
    timeWindow: 60    // per√≠odo em segundos
  }
});
```

### **Vari√°veis de Ambiente (.env)**
```env
# Token do bot (OBRIGAT√ìRIO)
DISCORD_TOKEN=seu_token_aqui

# Configura√ß√µes opcionais
PREFIX=$
BOT_STATUS=online
BOT_ACTIVITY_NAME=com charms m√°gicos
BOT_ACTIVITY_TYPE=PLAYING

# IDs de usu√°rios admin (separados por v√≠rgula)
ADMIN_USERS=123456789012345678,987654321098765432

# Rate limiting
RATE_LIMIT_MAX=10
RATE_LIMIT_WINDOW=60

# Log level (DEBUG, INFO, WARN, ERROR, FATAL)
LOG_LEVEL=INFO
```

### **Scripts package.json**
```json
{
  "scripts": {
    "start": "bun run index.js",
    "dev": "bun --watch run index.js",
    "test": "echo 'Testando bot...' && bun run index.js --test",
    "build": "bun build index.js --outdir ./dist"
  }
}
```

---

## üé® Exemplos Pr√°ticos

### **Bot de Modera√ß√£o**
```javascript
// Sistema de warn
const warnCharm = async (context) => {
  const { message, args, user } = context;
  
  if (!user.isAdmin) return;
  
  const mention = message.mentions.users.first();
  if (!mention) {
    await message.reply('‚ùå Mencione um usu√°rio para avisar');
    return;
  }
  
  const reason = args.split(' ').slice(1).join(' ') || 'Sem motivo';
  
  await message.channel.send(
    `‚ö†Ô∏è **${mention.username}** recebeu um aviso!\n` +
    `**Motivo:** ${reason}\n` +
    `**Moderador:** ${user.username}`
  );
};

client.registerCharm(warnCharm, {
  name: 'warn',
  description: 'Avisar um usu√°rio',
  usage: '$warn @usuario [motivo]',
  adminOnly: true,
  cooldown: 5,
  category: 'moderation'
});
```

### **Sistema de Tickets**
```javascript
const ticketCharm = async (context) => {
  const { message, args, client } = context;
  
  if (!args) {
    await message.reply('‚ùå Descreva o problema: `$ticket Meu problema aqui`');
    return;
  }
  
  // Criar canal de ticket
  const guild = message.guild;
  const channel = await guild.channels.create({
    name: `ticket-${message.author.username}`,
    type: ChannelType.GuildText,
    permissionOverwrites: [
      {
        id: guild.id,
        deny: [PermissionFlagsBits.ViewChannel]
      },
      {
        id: message.author.id,
        allow: [PermissionFlagsBits.ViewChannel, PermissionFlagsBits.SendMessages]
      }
    ]
  });
  
  await channel.send(
    `üé´ **Ticket criado por ${message.author}**\n` +
    `**Problema:** ${args}\n\n` +
    `Nossa equipe responder√° em breve!`
  );
  
  await message.reply(`‚úÖ Ticket criado: ${channel}`);
};
```

### **Sistema de Economia**
```javascript
// Comando de daily coins
const dailyCharm = async (context) => {
  const { message, user } = context;
  
  // Verificar se j√° coletou hoje (usar banco de dados real)
  const lastDaily = getUserLastDaily(user.id);
  const now = Date.now();
  
  if (lastDaily && (now - lastDaily) < 86400000) { // 24 horas
    const remaining = 86400000 - (now - lastDaily);
    const hours = Math.ceil(remaining / 3600000);
    
    await message.reply(`‚è∞ Pr√≥ximo daily em ${hours} horas!`);
    return;
  }
  
  // Dar coins
  const coins = Math.floor(Math.random() * 1000) + 500;
  addUserCoins(user.id, coins);
  setUserLastDaily(user.id, now);
  
  await message.reply(
    `üí∞ **Daily coletado!**\n` +
    `Voc√™ ganhou **${coins}** moedas!\n` +
    `Saldo total: **${getUserCoins(user.id)}** moedas`
  );
};
```

---

## üß™ Testes Automatizados

O framework vem com testes completos:

```bash
# Executar todos os testes
bun test

# Testes com cobertura
bun test --coverage

# Testes espec√≠ficos
bun test tests/unit/charms.test.ts
```

### **Criar Seus Pr√≥prios Testes**
```javascript
import { test, expect } from 'bun:test';
import { testMocks } from './setup.js';
import { meuCharm } from '../src/charms/meuCharm.js';

test('meu charm deve funcionar corretamente', async () => {
  const context = testMocks.createCharmContext({
    args: 'teste',
    user: { isAdmin: true }
  });
  
  let replyMessage = '';
  context.message.reply = async (content) => {
    replyMessage = content;
  };
  
  await meuCharm(context);
  
  expect(replyMessage).toContain('Funcionou!');
});
```

---

## üöÄ Deploy e Produ√ß√£o

### **Hospedagem Recomendada**

#### **Railway** (Mais f√°cil)
```bash
# 1. Instale Railway CLI
npm install -g @railway/cli

# 2. Fa√ßa login
railway login

# 3. Deploy
railway up
```

#### **Heroku**
```bash
# 1. Crie Procfile
echo "worker: bun run index.js" > Procfile

# 2. Deploy
git add .
git commit -m "Deploy bot"
git push heroku main
```

#### **VPS/Servidor Pr√≥prio**
```bash
# 1. Instale depend√™ncias
curl -fsSL https://bun.sh/install | bash
git clone seu-repositorio
cd seu-bot
bun install

# 2. Use PM2 para gerenciar
npm install -g pm2
pm2 start index.js --name "meu-bot"
pm2 startup
pm2 save

# 3. Configurar restart autom√°tico
pm2 restart meu-bot --cron "0 4 * * *" # Todo dia √†s 4h
```

### **Configura√ß√£o de Produ√ß√£o**
```javascript
// index.js (produ√ß√£o)
import { CharmClient } from 'deepcode-charm';

const client = new CharmClient({
  // ... configura√ß√µes
  
  // Logs apenas para erros em produ√ß√£o
  logLevel: process.env.NODE_ENV === 'production' ? 'ERROR' : 'DEBUG'
});

// Graceful shutdown
process.on('SIGINT', async () => {
  console.log('Desligando bot...');
  await client.shutdown();
  process.exit(0);
});

process.on('SIGTERM', async () => {
  await client.shutdown();
  process.exit(0);
});
```

---

## ü§ù Contribuindo

### **Reportar Bugs**
1. Verifique se o bug j√° foi reportado nas [Issues](https://github.com/seu-usuario/deepcode-charm/issues)
2. Crie uma nova issue com:
   - Descri√ß√£o clara do problema
   - Passos para reproduzir
   - Vers√£o do framework
   - Logs relevantes

### **Sugerir Features**
1. Abra uma [Discussion](https://github.com/seu-usuario/deepcode-charm/discussions)
2. Descreva a funcionalidade desejada
3. Explique o caso de uso
4. Aguarde feedback da comunidade

### **Contribuir com C√≥digo**
```bash
# 1. Fork o reposit√≥rio
# 2. Clone seu fork
git clone https://github.com/seu-usuario/deepcode-charm.git

# 3. Crie uma branch
git checkout -b minha-feature

# 4. Instale depend√™ncias
bun install

# 5. Execute os testes
bun test

# 6. Fa√ßa suas altera√ß√µes
# 7. Adicione testes para suas altera√ß√µes
# 8. Execute os testes novamente
bun test

# 9. Commit suas mudan√ßas
git add .
git commit -m "feat: adicionar nova funcionalidade"

# 10. Push e abra um Pull Request
git push origin minha-feature
```

---

## üìñ Links √öteis

### **Documenta√ß√£o**
- üìö [Documenta√ß√£o Completa](docs/USAGE.md)
- üîí [Guia de Seguran√ßa](docs/SECURITY.md)
- üöÄ [Guia de Publica√ß√£o](PUBLISH_GUIDE.md)

### **Comunidade**
- üí¨ [Discord Server](https://discord.gg/deepcodecharm)
- üêõ [Reportar Bugs](https://github.com/seu-usuario/deepcode-charm/issues)
- üí° [Sugest√µes](https://github.com/seu-usuario/deepcode-charm/discussions)

### **Recursos Externos**
- üìò [Discord.js Guide](https://discordjs.guide/)
- üèÉ‚Äç‚ôÇÔ∏è [Bun Documentation](https://bun.sh/docs)
- üéÆ [Discord Developer Portal](https://discord.com/developers/applications)

---

## üìÑ Licen√ßa

Este projeto est√° licenciado sob a **MIT License** - veja o arquivo [LICENSE](LICENSE) para detalhes.

---

## üôè Agradecimentos

- **Discord.js Team** - Pela incr√≠vel biblioteca
- **Bun Team** - Pelo runtime super r√°pido
- **aoi.js Community** - Pela inspira√ß√£o original
- **Todos os contribuidores** - Por fazer este projeto crescer

---

<div align="center">

**Criado com ‚ù§Ô∏è pela DeepCode Charm Team**

[‚¨ÜÔ∏è Voltar ao topo](#-deepcode-charm-framework)

</div>
